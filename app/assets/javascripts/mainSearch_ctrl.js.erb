(function (){

  "use strict"; 
  angular.module("app",["ui.bootstrap","ngAnimate"]).controller("mainSearchCtrl", function($scope,$http) {


      $scope.setup = function(){
      $http.get("/api/v1/autos.json").then(function(response){
      $scope.autoMakers = response.data;
      });
    }


      $scope.makeDescription = "Select a Make";
      $scope.modelDescription = "Select a Model";
      $scope.autoSearches = {}; 
      $scope.autoSearchesIndex = [];

      $scope.tabUnlock = function(make,index){
        // console.log(make);
        $scope.modelNames = [];
        $scope.autoYears = [];
        for(var i = 0; i < $scope.autoMakers.length; i++){
            var mymake = $scope.autoMakers[i];
            if(mymake.make_name === make){
            
            if($scope.autoSearchesIndex.indexOf(index) === -1){
              $scope.autoSearches.make = make; 
              $scope.autoSearchesIndex.push(index);
            }  else {
              var myIndex = $scope.autoSearchesIndex.indexOf(index);
              $scope.autoSearches.splice(myIndex, 1);
              $scope.autoSearchesIndex.splice(myIndex,1); 
            }
              // console.log(mymake.auto_details.auto_models);
              console.log($scope.autoSearches);

              
              $scope.makeDescription = mymake.make_description;
              // console.log($scope.makesDescription);
              $scope.models = mymake.auto_details.auto_models;
              for(var j = 0; j < $scope.models.length; j++){
                 $scope.modelNames.push($scope.models[j].model_name); 
                  // console.log($scope.modelNames);
              }
            }
        }
        var currentYear = new Date().getFullYear();
        
        // console.log(currentYear);
        
        for(var i = 1980;i < currentYear; i++){
          $scope.autoYears[i-1980] = i;
        }

        // console.log($scope.autoYears);
        
      }

      $scope.tabUnlock2 = function(model,index){
        console.log(model);
        console.log(index);
      }
       


    window.$scope = $scope;
  

  });
}());